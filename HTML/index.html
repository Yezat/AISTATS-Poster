<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>A High Dimensional Statistical Model for Adversarial Training</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="poster">
    <div class="header">
      Exact Asymptotics of <b>Adversarial Training</b>: Characterizing the Geometry of <b>Robustness-Accuracy Trade-Offs</b>
      <div class="plot-container">
        <!-- <img src="../Assets/feature_combinations_alpha_sweep.pdf" alt="Feature combinations alpha sweep" style="width: 60%;"> -->
        <img src="../Assets/feature_combinations_alpha_sweep.svg" alt="Feature combinations alpha sweep" style="width: 100%;">
      </div>
    </div>

    <div class="content-box">
      <h1>A High-dimensional Statistical Model for Adversarial Training: Geometry and Trade-Offs</h1>

    <div class="main-content">
      
      <div class="section">
        <h2>Problem Setup</h2>
        <p><strong>Binary Classification Setting:</strong></p>
        <ul>
          <li>Training data \(\mathcal{D} = \{(x_i, y_i)\}_{i=1}^{n} \in \mathbb{R}^{d} \times \{-1,+1\}\)</li>
          <li>Probit model with noise parameter \(\tau > 0\)</li>
          <li>High-dimensional limit: \(d,n \to \infty\) with fixed \(\alpha = n/d\)</li>
          <li>Structured data with block features: covariance matrices \(\Sigma_x, \Sigma_\delta, \Sigma_\upsilon, \Sigma_\theta\) are block diagonal with \(k\) blocks of sizes \(d_1, \dots, d_k\)</li>
        </ul>

        <p><strong>Metrics of Interest:</strong></p>
        
        <p>Generalisation Error:</p>
        <div class="math-block">
          \[E_{\text{gen}} = \mathbb{E}_{y,x}[ \mathbb{1}(y \neq \hat{y} (\hat{w}, x)) ]\]
        </div>

        <p>Adversarial Generalisation Error:</p>
        <div class="math-block">
          \[E_{\text{adv}} = \mathbb{E}_{y,x}[ \max_{\|\delta\|_{\Sigma_\upsilon^{-1}} \leq \varepsilon_g} \mathbb{1}(y \neq \hat{y} (\hat{w}, x + \delta)) ]\]
        </div>

        <p>Boundary Error:</p>
        <div class="math-block">
          \[E_{\text{adv}} = E_{\text{gen}} + E_{\text{bnd}}\]
        </div>
        <p>where \(E_{\text{bnd}}\) represents the attackable samples.</p>
      </div>

      <div class="section span-2">
        <h2>Directional Defences and structured data</h2>
        <p><strong>Key Finding:</strong> The choice of defense strategy significantly impacts adversarial performance:</p>
        <div class="plot-container">
          <img class="plot" src="../Assets/defence_sweep.pdf" alt="Impact of different defense strategies on generalization \(E_{\text{gen}}\) and boundary \(E_{\text{bnd}}\) errors">
          <p class="plot-caption">Impact of different defense strategies on generalization \(E_{\text{gen}}\) and boundary \(E_{\text{bnd}}\) errors</p>
        </div>
        <ul>
          <li><strong>Defending robust features:</strong> Low \(E_{\text{gen}}\) but high \(E_{\text{bnd}}\)</li>
          <li><strong>Uniform defense:</strong> Better balance, improves overall \(E_{\text{adv}}\)</li>
          <li><strong>Defending non-robust features:</strong> Increases \(E_{\text{gen}}\) while decreasing \(E_{\text{bnd}}\)</li>
        </ul>
      </div>

      <div class="section">
        <h2>Main Result</h2>
        <p><strong>Theorem:</strong> Adversarial generalization errors are <em>provably</em> characterized by a system of 8 order parameters \((m, q, V, P, \hat{m}, \hat{q}, \hat{V}, \hat{P})\) and an additional parameter \(A\) through:</p>
        <div class="math-block">
          \[E_{\text{gen}} = \frac{1}{\pi} \arccos\left( \frac{m}{\sqrt{(\rho + \tau^2)q}} \right)\]
          \[E_{\text{bnd}} = \int_{0}^{\varepsilon_g \frac{\sqrt{A}}{\sqrt{q}}} \text{erfc}\left( \frac{-\frac{m}{\sqrt{q}} \nu}{\sqrt{2(\rho + \tau^2 - m^2/q)}} \right) \frac{e^{-\frac{\nu^2}{2}}}{\sqrt{2\pi}} d\nu\]
        </div>

        <h2>Implications</h2>
        <h3>Trade-off between Usefulness and Robustness</h3>
        <ul>
          <li>Usefulness relates to generalisation error</li>
          <li>Robustness relates to boundary error</li>
          <li>Trade-off emerges when protecting useful but non-robust features</li>
        </ul>

        <p><strong>Key Bounds:</strong></p>
        <div class="math-block">
          \[E_{\text{gen}} \geq \frac{1}{\pi} \arccos(\sqrt{\frac{\pi}{2\rho}} \mathcal{U}_{w^*})\]
          \[E_{\text{bnd}} \leq 2T(\varepsilon_g \mathcal{A} \mathcal{B}, \mathcal{A}^{-1}) - \frac{1}{\pi} \arctan(\mathcal{A}^{-1}) - \frac{1}{\pi} \text{erf}(\frac{\varepsilon_g \mathcal{B}}{\sqrt{2}}) \text{erfc}(\frac{\varepsilon_g \mathcal{A} \mathcal{B}}{\sqrt{2}})\]
        </div>
      </div>


      <div class="section">
        <h2>Tradeoff directions and innocuous directions</h2>
        <p><strong>Key Insight:</strong> The geometry of features determines whether adversarial training leads to a trade-off:</p>
        <div class="plot-container">
          <img src="../Assets/optimal_defense.pdf" alt="Impact of adversarial training on features with different geometries" style="width: 100%; max-width: 600px;">
          <p class="plot-caption">Impact of adversarial training on features with different geometries</p>
        </div>
        <p><strong>Two Distinct Cases:</strong></p>
        <ul>
          <li><strong>Innocuous Features</strong> (orthogonal to teacher):
            <ul>
              <li>Attack can be completely neutralized</li>
              <li>\(E_{\text{adv}} \to E_{\text{gen}}\) as adversarial training cost \(\varepsilon_t\) increases</li>
              <li>\(E_{\text{bnd}} \to 0\) with sufficiently large \(\varepsilon_t\)</li>
            </ul>
          </li>
          <li><strong>Trade-off Features</strong> (aligned with teacher):
            <ul>
              <li>Fundamental trade-off between \(E_{\text{gen}}\) and \(E_{\text{bnd}}\)</li>
              <li>Optimal performance at specific adversarial training cost</li>
            </ul>
          </li>
        </ul>
      </div>

      <div class="section">
        <h2>Data Dependent Regularisation</h2>
        <p><strong>Key Finding:</strong> Adversarial training can be approximated as a data-dependent regularisation:</p>
        <div class="plot-container side-by-side">
          <div class="plot-wrapper">
            <img class="plot" src="../Assets/effective_regularisation.pdf" alt="Learning curves for adversarial training and its regularisation approximation">
            <p class="plot-caption">Learning curves for adversarial training (top) and its regularisation approximation (bottom)</p>
          </div>
          <div class="plot-wrapper">
            <img class="plot" src="../Assets/gen_lambda_optimal_sweep_alpha.pdf" alt="Adversarial training is not just an \(\ell_2\) regularisation">
            <p class="plot-caption">Adversarial training is not just an \(\ell_2\) regularisation</p>
          </div>
        </div>
        <div class="math-block">
          \[\sum_{i = 1}^{n} g(y_i \frac{w^\top x_i}{\sqrt{d}}) + \tilde{\lambda}_1 \sqrt{w^\top \Sigma_\delta w} + \tilde{\lambda}_2 w^\top \Sigma_\delta w\]
        </div>
        <ul>
          <li><strong>Effective Regularisation:</strong> is a directional \(\sqrt{\ell_2} + \ell_2\) regularisation</li>
          <li><strong>Non-sparse:</strong> \(\sqrt{\ell_2}\) term provides linear scaling in the norm of the student vector without sparsity</li>
        </ul>
      </div>

    </div>
    </div>

    <div class="footer">
      <div class="credits">
        <div class="qr-code">
          <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://arxiv.org/abs/2402.05674" alt="QR Code to paper">
        </div>
        <div class="credits-content">
          Kasimir Tanner<br>
          Matteo Vilucchio<br>
          Bruno Loureiro<br>
          Florent Krzakala<br>
        </div>
        
      </div>
      <div class="logo-container">
        <div class="logo">
          <img src="../Assets/EPFL_Logo_Digital_WHITE_PROD.png" alt="EPFL Logo">
        </div>
        <div class="logo">
          <img src="../Assets/logo_ens_psl_blanc_500px.png" alt="ENS Logo">
        </div>
      </div>
    </div>
  </div>
</body>
</html>
